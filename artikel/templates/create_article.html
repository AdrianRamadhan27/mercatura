{% extends 'base.html' %}

{% block meta %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
  const articlePost = function(article) {
    $.post("/artikel/create/", {
      ...article,
      csrfmiddlewaretoken: "{{ csrf_token }}"
    },
    
    function(data) {
      window.location.href = "/artikel/";
      console.log(data);
    })
  }

  $(document).ready(
    function() {
      $(".submit-article").click(function() {
        const article = {
          title: $(".inp-title").val(),
          image_url: $(".inp-img-url").val(),
          description: $(".inp-description").val()
        }
    
        articlePost(article);
        return false;
      });
    }
  )
</script>

{% endblock meta %}

{% load filters %}

{% block content %}
<div class="h-full w-full flex justify-center items-center font-poppins bg-purple-3">
  <div class="flex flex-col w-[90%] w-full p-10 gap-6">
    <div  class="mb-6 text-center"> 
      <h1 class="text-pink-1 font-bold text-4xl mb-4">Tambah Artikel Baru</h1>
      <p>Artikelmu pasti sangat bermanfaat! Artikel milikmu nantinya akan ditampilkan pada halaman <span class="text-purple-1 font-semibold"><a href={% url 'artikel:show_artikel' %}>Kumpulan Artikel</a></span>.</p>
      <div class="w-full flex justify-center pt-6">
        <div class="w-[10%] border-b-4 border-pink-1"></div>
      </div>
    </div>
  
    <form method="POST">
      {% csrf_token %}
          <div class="md:flex md:space-x-10 space-y-4 md:space-y-0">
            <div class="flex flex-col md:w-[40%] w-full md:gap-4 space-y-4 md:space-y-0">
              <div class="flex flex-col items-start w-full">
                <p class="text-purple-1 text-lg font-semibold">Judul <span class="text-xs text-pink-1">* maksimal 100 karakter</span></p>
                {{ form.title|addclass:"inp-title focus:outline-purple-1 caret-pink-1 shadow-lg rounded-lg py-2 px-2 w-full"}}
              </div>
              <div class="flex flex-col items-start justify-between">
                <p class="text-purple-1 text-lg font-semibold">Tautan Gambar</p>
                {{ form.image_url|addclass:"inp-img-url focus:outline-purple-1 caret-pink-1 shadow-lg rounded-lg py-2 px-2 h-20 w-full"}}
              </div>
            </div>
            <div class="flex flex-col md:w-[60%] w-full md:items-start md:justify-between">
              <p class="text-purple-1 text-lg font-semibold">Deskripsi <span class="text-xs text-pink-1">* maksimal 2000 karakter</span></p>
              {{ form.description|addclass:"inp-description items-start focus:outline-purple-1 caret-pink-1 shadow-lg rounded-lg w-full py-2 px-2 md:h-80"}}
            </div>
          </div>

        <div class="font-poppins text-xs text-center font-bold text-pink-1 mt-2 mb-10">
          {{ form.title.errors }}
          {{ form.description.errors }}
          {{ form.image_url.errors }}
        </div>

        <button class="submit-article w-full">
          <input class="text-white mt-2 w-auto bg-gradient-to-r hover:bg-gradient-to-l from-purple-1 to-pink-1 font-extrabold rounded-full text-md md:px-5 md:py-2 px-4 py-3 text-center mb-2" type="submit" name="submit" value="Tambahkan Artikel">
        </button>
      </div>
    </form>
  </div>

  {% if messages %}  
  <ul>   
      {% for message in messages %}  
          <li>{{ message }}</li>  
          {% endfor %}  
  </ul>   
  {% endif %}
</div>
{% endblock content %}